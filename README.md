# CSMF
Simultaneously learning Common and Specific patterns via Matrix Factorization
- CSMF is a powerful tool to simultaneously reveals common and specific patterns from data generated under interrelated biological scenarios (e.g., cells, tissues and conditions). 
- CSMF uncovers common and specific patterns with significant biological implications in various data types such as RNA-seq, Chip-seq and scRNA-seq. 
- CSMF is a flexible non-negative matrix factorization framework, which combines data dimension reduction and differential analysis into one paradigm. 
- CSMF can infer the ranks of common patterns and specific patterns in an unsupervised manner. 

Check out our paper for a more complete description of the methods and analyses [(L.Zhang and S.Zhang, Nucleic Acids Research, 2019)](https://academic.oup.com/nar/advance-article/doi/10.1093/nar/gkz488/5512984). 

## Tutorials and Examples
In this Matlab live script (generated by Matlab R2018b), we currently provide two example workflows that outline the key steps of CSMF ([Walkthrough](https://github.com/amsszlh/CSMF/blob/master/Examples/CSMF_tutorials.pdf)). 

- Simulation data: In this simulation data, the number of samples of the first and second condition are 100 and 120, respectively. The number of features is 300. The common rank between these two data is 5, and the specific ranks are 10 and 10, respectively. 
- ChIP-seq data of two cell lines: This data describes the chromatin modification map on protein-DNA interactions between K562 and Huvec cell lines. This data consists of 58997 loci and 18 histone marks or TFs of K562 and Huvec cell lines.

## Key notations in this script
- X = [X1, X2, ..., Xk] is the concatenated data matrix from k conditions (Xk). 
- vecN = [n1, n2, ..., nk] defines the number of samples in each condition k (nk)
- vecPara = [rc, rs1, rs2, ..., rsk] defines the ranks of the common pattern (rc) and the k-th specific pattern (rsk).  
- The i-th common pattern is represented by C-i, and the j-th specific pattern for the k-th condition is represented by Sk-j.


## Help
If you have any problems, comments or suggestions, please contact us at Lihua Zhang (zhanglihua@amss.ac.cn) or Shihua Zhang (zsh@amss.ac.cn).
